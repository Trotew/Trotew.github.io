<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="contest,">










<meta name="description" content="比赛节奏不错，但是最后出现了写题责任分配上的问题。  A 分类讨论（大串暴力匹配，小串哈希处理） D 容斥+二维莫队 F 解方程 G 计数（容斥） H 思维状压DP I 思维 J 树上最大子段和（倍增、LCT、树剖） K 前缀优化计数dp  其中BE为温暖的签到题。C题为较为简单的计数和容斥原理，在此不予讨论。">
<meta name="keywords" content="contest">
<meta property="og:type" content="article">
<meta property="og:title" content="EyeBigBird2 2016 CT S03E07 2019.02.21">
<meta property="og:url" content="http://Trotew.github.io/2019/02/25/CT-S03E07/index.html">
<meta property="og:site_name" content="飘雨小镇">
<meta property="og:description" content="比赛节奏不错，但是最后出现了写题责任分配上的问题。  A 分类讨论（大串暴力匹配，小串哈希处理） D 容斥+二维莫队 F 解方程 G 计数（容斥） H 思维状压DP I 思维 J 树上最大子段和（倍增、LCT、树剖） K 前缀优化计数dp  其中BE为温暖的签到题。C题为较为简单的计数和容斥原理，在此不予讨论。">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-03-02T16:51:17.643Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="EyeBigBird2 2016 CT S03E07 2019.02.21">
<meta name="twitter:description" content="比赛节奏不错，但是最后出现了写题责任分配上的问题。  A 分类讨论（大串暴力匹配，小串哈希处理） D 容斥+二维莫队 F 解方程 G 计数（容斥） H 思维状压DP I 思维 J 树上最大子段和（倍增、LCT、树剖） K 前缀优化计数dp  其中BE为温暖的签到题。C题为较为简单的计数和容斥原理，在此不予讨论。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://Trotew.github.io/2019/02/25/CT-S03E07/">





  <title>EyeBigBird2 2016 CT S03E07 2019.02.21 | 飘雨小镇</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">飘雨小镇</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">一天进步一点</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://Trotew.github.io/2019/02/25/CT-S03E07/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Trote_w">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飘雨小镇">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">EyeBigBird2 2016 CT S03E07 2019.02.21</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-25T13:01:41+08:00">
                2019-02-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>比赛节奏不错，但是最后出现了写题责任分配上的问题。</p>
<ul>
<li>A 分类讨论（大串暴力匹配，小串哈希处理）</li>
<li>D 容斥+二维莫队</li>
<li>F 解方程</li>
<li>G 计数（容斥）</li>
<li>H 思维状压DP</li>
<li>I 思维</li>
<li>J 树上最大子段和（倍增、LCT、树剖）</li>
<li>K 前缀优化计数dp</li>
</ul>
<p>其中BE为温暖的签到题。<br>C题为较为简单的计数和容斥原理，在此不予讨论。</p>
<a id="more"></a>
<h1 id="A-字符串分类讨论（大串暴力匹配，小串哈希处理）"><a href="#A-字符串分类讨论（大串暴力匹配，小串哈希处理）" class="headerlink" title="A. 字符串分类讨论（大串暴力匹配，小串哈希处理）"></a>A. 字符串分类讨论（大串暴力匹配，小串哈希处理）</h1><h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>给定$n$个字符串</p>
<script type="math/tex; mode=display">S_0,S_1,\cdots,S_{n-1}</script><p>总大小不超过 $k$ 。</p>
<p>随后$q$次强制在线的查询，需要支持两个操作：</p>
<ul>
<li>给定一个母串，问是否有一个$S_i$是其子串，所有这类询问的母串总大小不超过$k$。</li>
<li>指定一个子串，在其后面增加一个字符$c$。</li>
</ul>
<p>$n,q,k\le 2e5$</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>分类为以下两种情况处理：</p>
<ul>
<li>对于查询中，母串长度小于$\sqrt k$的，通过哈希预处理解决，时间复杂度$O(len*q)$。当$len=k$时复杂度最大，此时最多仅有$\sqrt k$个母串，总时间复杂度$O(k\sqrt k)$</li>
<li>对于查询中，母串长度大于$\sqrt k$的，通过暴力匹配解决，这里使用C++17标准库的BM匹配算法，单词时间复杂度$O(k)$，总时间复杂度$O(k\sqrt k)$</li>
</ul>
<p>以上，总时间复杂度$O(k\sqrt k)$。</p>
<p>其实也有别的分类方法或者自动机方法，在此不予讨论。</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(x) (int)x.size()</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mn = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> td = <span class="number">450</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, q;</span><br><span class="line"><span class="built_in">string</span> s[mn], t;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Hash</span> &#123;</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> seed = <span class="number">31</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; h[td + <span class="number">10</span>];</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">hash_func</span><span class="params">(<span class="keyword">int</span> &amp;u, <span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">        u = ((ll)u * seed + c - <span class="string">'a'</span> + <span class="number">1</span>) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="built_in">string</span> &amp;s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> u = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; sz(s); j++) &#123;</span><br><span class="line">            hash_func(u, s[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        h[sz(s)][u]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="built_in">string</span> &amp;s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> u = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; sz(s); j++) &#123;</span><br><span class="line">            hash_func(u, s[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        h[sz(s)][u]--;</span><br><span class="line">        <span class="keyword">if</span> (h[sz(s)][u] == <span class="number">0</span>) h[sz(s)].erase(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">query</span><span class="params">(<span class="built_in">string</span> &amp;s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sz(s); i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> u = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; min(sz(s), i + td); j++) &#123;</span><br><span class="line">                hash_func(u, s[j]);</span><br><span class="line">                <span class="keyword">if</span> (h[j - i + <span class="number">1</span>].count(u)) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; h;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">string_in</span><span class="params">(<span class="built_in">string</span> &amp;needle, <span class="built_in">string</span> &amp;in)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> it = <span class="built_in">std</span>::search(</span><br><span class="line">        in.begin(), in.end(),</span><br><span class="line">        <span class="built_in">std</span>::boyer_moore_horspool_searcher(needle.begin(), needle.end()));</span><br><span class="line">    <span class="keyword">if</span> (it != in.end()) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">query</span><span class="params">(<span class="built_in">string</span> &amp;u)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="keyword">if</span> (sz(s[i]) &lt;= sz(u) &amp;&amp; string_in(s[i], u)) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span>.sync_with_stdio(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; s[i];</span><br><span class="line">        <span class="keyword">if</span> (sz(s[i]) &lt; td) h.ins(s[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> last = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> p = <span class="number">0</span>; p &lt; q; p++) &#123;</span><br><span class="line">        <span class="keyword">int</span> u;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; u;</span><br><span class="line">        <span class="keyword">bool</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (u == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; t;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i : t) i = (i - <span class="string">'a'</span> + last) % <span class="number">26</span> + <span class="string">'a'</span>;</span><br><span class="line">            <span class="keyword">if</span> (sz(t) &gt;= td)</span><br><span class="line">                ans = query(t);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                ans = h.query(t);</span><br><span class="line">            <span class="keyword">if</span> (ans) &#123;</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">"YES"</span>);</span><br><span class="line">                last = p;</span><br><span class="line">            &#125; <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">"NO"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> v, w;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; v &gt;&gt; w;</span><br><span class="line">            v = (v + last) % n;</span><br><span class="line">            <span class="keyword">char</span> c = (w + last) % <span class="number">26</span> + <span class="string">'a'</span>;</span><br><span class="line">            <span class="keyword">if</span> (sz(s[v]) &lt; td) &#123;</span><br><span class="line">                h.del(s[v]);</span><br><span class="line">                s[v].pb(c);</span><br><span class="line">                <span class="keyword">if</span> (sz(s[v]) &lt; td) h.ins(s[v]);</span><br><span class="line">            &#125; <span class="keyword">else</span></span><br><span class="line">                s[v].pb(c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="D-容斥-二维莫队"><a href="#D-容斥-二维莫队" class="headerlink" title="D.容斥+二维莫队"></a>D.容斥+二维莫队</h1><h2 id="题意-1"><a href="#题意-1" class="headerlink" title="题意"></a>题意</h2><p>给定一个长度为$n$的数列$a$，每次询问两个区间，要求统计$a$数列两个区间中相同元素对数</p>
<p>$1 \le n \le 5*10^5$</p>
<h2 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h2><p>记$S(l,r,x)$表示$[l,r]$区间中x出现的次数</p>
<p>题目等价于求解$\sum_{x=1}^nS(l1,r1,x)*S(l2,r2,x)$</p>
<p>容斥得到</p>
<script type="math/tex; mode=display">\sum_{x=1}^n{S(l1,r1,x)*S(l2,r2,x)}=\sum_{x=1}^n{S(1,r1,x)*S(1,r2,x)-S(1,l1-1,x)*S(1,r2,x)-S(1,l2-1,x)*S(1,r1,x)+S(1,l1-1,x)*S(1,l2-1,x)}</script><p>记$Q(l,r)$为$\sum_{x=1}^nS(1,l,x)*S(1,r,x)$</p>
<p>那么原题等价于求解$Q(r1,r2)-Q(l1-1,r2)-Q(l2-1,r1)+Q(l1-1,l2-1)$</p>
<p>Q可以通过二维莫队求解</p>
<h2 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">400010</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">int</span> a[N], pos[N], n, m, k, limit, i, l, r, cnt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Q</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, id, t;</span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Q &amp;a, <span class="keyword">const</span> Q &amp;b) &#123;</span><br><span class="line">        <span class="keyword">return</span> pos[a.l] &lt; pos[b.l] || (pos[a.l] == pos[b.l] &amp;&amp; a.r &lt; b.r);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; ask[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> Q &amp;a, <span class="keyword">const</span> Q &amp;b)</span> </span>&#123; <span class="keyword">return</span> a.id &lt; b.id; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> id, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">    ++cnt;</span><br><span class="line">    ask[cnt].l = l;</span><br><span class="line">    ask[cnt].r = r;</span><br><span class="line">    ask[cnt].id = id;</span><br><span class="line">    ask[cnt].t = t;</span><br><span class="line">&#125;</span><br><span class="line">LL ans[N], Ans, totl[N], totr[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    limit = (<span class="keyword">int</span>)<span class="built_in">sqrt</span>(n + <span class="number">0.5</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        pos[i] = (i - <span class="number">1</span>) / limit + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> l1, r1, l2, r2;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;l1, &amp;r1, &amp;l2, &amp;r2);</span><br><span class="line">        add(r1, r2, i, <span class="number">1</span>);</span><br><span class="line">        add(l1 - <span class="number">1</span>, r2, i, <span class="number">-1</span>);</span><br><span class="line">        add(l2 - <span class="number">1</span>, r1, i, <span class="number">-1</span>);</span><br><span class="line">        add(l1 - <span class="number">1</span>, l2 - <span class="number">1</span>, i, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    sort(ask + <span class="number">1</span>, ask + cnt + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>, l = <span class="number">0</span>, r = <span class="number">0</span>; i &lt;= cnt; i++) &#123;</span><br><span class="line">        <span class="keyword">while</span> (r &lt; ask[i].r) ++r, totr[a[r]]++, Ans += totl[a[r]];</span><br><span class="line">        <span class="keyword">while</span> (r &gt; ask[i].r) totr[a[r]]--, Ans -= totl[a[r]], r--;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; ask[i].l) ++l, totl[a[l]]++, Ans += totr[a[l]];</span><br><span class="line">        <span class="keyword">while</span> (l &gt; ask[i].l) totl[a[l]]--, Ans -= totr[a[l]], l--;</span><br><span class="line">        ans[ask[i].id] += Ans * ask[i].t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="F-解方程"><a href="#F-解方程" class="headerlink" title="F. 解方程"></a>F. 解方程</h1><h2 id="题意-2"><a href="#题意-2" class="headerlink" title="题意"></a>题意</h2><p>求周期函数和二次函数的交点。</p>
<h2 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h2><p>把所有 $x \% n$ 相等的点连成直线，求这 $n$ 条直线与二次函数 $-\frac{1}{2}x(x+1)+h$ 的最小整数交点。</p>
<p>可以不用二分，但必须用 long double。</p>
<h2 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cin</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> db = <span class="keyword">long</span> <span class="keyword">double</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, h;</span><br><span class="line">LL A[MAXN];</span><br><span class="line"><span class="function">db <span class="title">f1</span><span class="params">(db x)</span> </span>&#123; <span class="keyword">return</span> (db)<span class="number">-0.5</span> * x * (x + <span class="number">1.0</span>) + h; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; h;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">cin</span> &gt;&gt; A[i], A[i] += A[i - <span class="number">1</span>];</span><br><span class="line">    db k = (db)A[n] / n;</span><br><span class="line">    LL ans = <span class="number">2e18</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (A[i] &gt;= f1(i)) &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; i;</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">auto</span> f2 = [&amp;](db x) &#123;<span class="keyword">return</span> k * (x - i) + A[i]; &#125;;</span><br><span class="line">        LL l = <span class="number">1</span>, r = <span class="number">1e18</span>, t = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">            LL m = l + (r - l) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (f2(m * n + i) &gt;= f1(m * n + i))</span><br><span class="line">                r = m - <span class="number">1</span>, t = m;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                l = m + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ans = <span class="built_in">std</span>::min(ans, t * n + i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="G-计数"><a href="#G-计数" class="headerlink" title="G.计数"></a>G.计数</h1><h2 id="题意-3"><a href="#题意-3" class="headerlink" title="题意"></a>题意</h2><p>给定一个数字$x$，要求构造长度为n的数列$A$，使得$a \le A_1 \le A_2 \le A_3 \le … \le A_n$，且A数列的最小公倍数能被数字$x$整除。</p>
<p>$1 \le n \le 100$</p>
<p>$1 \le a \le b \le 10^9$</p>
<h2 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h2><p>对于$x$因式分解有</p>
<script type="math/tex; mode=display">x=p_1^{y_1}*p_2^{y_2}*\cdots*p_u^{y_u}</script><p>因为要求$lcm$被$x$整除，所以必然有</p>
<script type="math/tex; mode=display">x|A_{b_1}* A_{b_2}* \cdots * A_{b_p}</script><p>只有$p_u^{y_u}|A_i$时，$A_i$对$lcm$才有贡献</p>
<p>因此我们只考虑通过组合因数的最大幂次来得到这个$lcm$</p>
<p>记$g[st]$为区间内数字约数中包含因数最大幂次集合st的数字数量，可以通过$b/t-(a-1)/t$得到</p>
<p>记$f[st]$为不包含集合st中数字作为约数的数字数量，$f[st]$可以通过容斥公式$f[st]=\sum_{i\subset st}{-1}^{|i|}*g[i]$得到</p>
<p>从大小为m的集合中挑选n个可重复数字作为数列A的值的方案数可以通过隔板法得到为$C_{n+m-1}^n$</p>
<p>那么答案就是总方案数-不合法方案数，有容斥公式$ans=\sum{-1^{|i|}}* C_{n+f[i]-1}^n$</p>
<h2 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> n, a, b, x;</span><br><span class="line"><span class="keyword">int</span> g[<span class="number">1</span> &lt;&lt; <span class="number">15</span>], f[<span class="number">1</span> &lt;&lt; <span class="number">15</span>];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v;</span><br><span class="line"><span class="function">ll <span class="title">inv</span><span class="params">(ll a, ll m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> inv(m % a, m) * (m - m / a) % m;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> U = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> F[U + <span class="number">3</span>], Finv[U + <span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    F[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= U; i++) F[i] = <span class="number">1l</span>l * F[i - <span class="number">1</span>] * i % P;</span><br><span class="line">    Finv[U] = inv(F[U], P);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = U; i; i--) Finv[i - <span class="number">1</span>] = <span class="number">1l</span>l * Finv[i] * i % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">comb</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) res = <span class="number">1l</span>l * res * (n - i) % P;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1l</span>l * res * Finv[m] % P;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_v</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= x; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x % i) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">int</span> t = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (x % i == <span class="number">0</span>) x /= i, t *= i;</span><br><span class="line">        v.push_back(t);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">1</span>) v.push_back(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bit</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> n &gt;&gt; x &amp; <span class="number">1</span>; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;n, &amp;a, &amp;b, &amp;x);</span><br><span class="line">    init();</span><br><span class="line">    get_v(x);</span><br><span class="line">    <span class="keyword">int</span> k = v.size();</span><br><span class="line">    <span class="keyword">int</span> st = <span class="number">1</span> &lt;&lt; k;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; st; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> t = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; k; j++)</span><br><span class="line">            <span class="keyword">if</span> (bit(i, j)) t = t * v[j];</span><br><span class="line">        g[i] = b / t - (a - <span class="number">1</span>) / t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; st; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i;; j = (j - <span class="number">1</span>) &amp; i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (__builtin_popcount(j) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">                f[i] -= g[j];</span><br><span class="line">                <span class="keyword">if</span> (f[i] &lt; <span class="number">0</span>) f[i] += P;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                f[i] += g[j];</span><br><span class="line">                <span class="keyword">if</span> (f[i] &gt;= P) f[i] -= P;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!j) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (__builtin_popcount(i) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">            ans -= comb(n + f[i] - <span class="number">1</span>, n);</span><br><span class="line">            <span class="keyword">if</span> (ans &lt; <span class="number">0</span>) ans += P;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ans += comb(n + f[i] - <span class="number">1</span>, n);</span><br><span class="line">            <span class="keyword">if</span> (ans &gt;= P) ans -= P;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="H-思维状压DP"><a href="#H-思维状压DP" class="headerlink" title="H. 思维状压DP"></a>H. 思维状压DP</h1><h2 id="题意-4"><a href="#题意-4" class="headerlink" title="题意"></a>题意</h2><p>给定$n$个硬币，每个硬币拥有一个$a_i$和一个$b_i$，接下来你需要选出一些硬币，使得这些硬币中选出一些的$a_i$总和能组成任意一个$[1,m]$。</p>
<p>除此之外，你需要保证你选出的硬币的$b_i$和最小。</p>
<p>$n\le 42,\ m\le 1e9$</p>
<h2 id="题解-4"><a href="#题解-4" class="headerlink" title="题解"></a>题解</h2><p>考虑对硬币按价值$a_i$排序。</p>
<p>我们可以考虑分段状态压缩，预处理前$21$个硬币，然后枚举最后$21$个硬币的情况。</p>
<p>前面部分使用DP维护能达成$S_i$之内所有顺序的$b_i$之和最小值。</p>
<p>后面部分枚举，并且从后面部分得到最少需要前面部分能达成$S_i$之内的所有元素。</p>
<p>以上即可，时间复杂度$O(n*2^n)$</p>
<h2 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll, ll&gt; pll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mn = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">item</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> d, a, id;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> item &amp;p) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (d != p.d) <span class="keyword">return</span> d &lt; p.d;</span><br><span class="line">        <span class="keyword">return</span> a &lt; p.a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; p[mn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bye</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mm = <span class="number">5e6</span> + <span class="number">5</span>;</span><br><span class="line">ll mini[mm];</span><br><span class="line"><span class="keyword">int</span> ans[mm];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getA</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> need = <span class="number">0</span>;</span><br><span class="line">    ll sum = <span class="number">0</span>;</span><br><span class="line">    ll suma = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">1l</span>l &lt;&lt; i) &amp; x) &#123;</span><br><span class="line">            need = max((ll)need, p[i].d - sum);</span><br><span class="line">            sum += p[i].d;</span><br><span class="line">            suma += p[i].a;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">21</span>) &#123;</span><br><span class="line">        need = max((ll)need, m - sum);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (need == <span class="number">1</span> &amp;&amp; sum &lt; <span class="number">5e6</span> &amp;&amp; mini[sum] &gt; suma) &#123;</span><br><span class="line">        mini[sum] = suma;</span><br><span class="line">        ans[sum] = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> need;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">pll <span class="title">getB</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">    ll sum = <span class="number">0</span>, need = <span class="number">0</span>;</span><br><span class="line">    ll suma = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">1l</span>l &lt;&lt; i) &amp; x) &#123;</span><br><span class="line">            need = max(need, p[i].d - sum);</span><br><span class="line">            sum += p[i].d;</span><br><span class="line">            suma += p[i].a;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;max(need - <span class="number">1</span>, m - sum), suma&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="number">-1</span>) bye();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, __builtin_popcountll(x));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">1l</span>l &lt;&lt; i) &amp; x) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d "</span>, p[i].id);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    ll sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;p[i].d, &amp;p[i].a), p[i].id = i + <span class="number">1</span>;</span><br><span class="line">    sort(p, p + n);</span><br><span class="line">    <span class="built_in">memset</span>(mini, <span class="number">1</span>, <span class="keyword">sizeof</span> mini);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; (<span class="number">1</span> &lt;&lt; min(n, <span class="number">21</span>)); i++) &#123;</span><br><span class="line">        getA(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">5e6</span>; i; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mini[i] &gt;= mini[i + <span class="number">1</span>]) mini[i] = mini[i + <span class="number">1</span>], ans[i] = ans[i + <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    ll mainans = <span class="number">-1</span>, minans = <span class="number">1e18</span>;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">21</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (m &lt; <span class="number">5e6</span> &amp;&amp; mini[m] &lt; <span class="number">1e12</span>) &#123;</span><br><span class="line">            print(ans[m]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> bye();</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; min(<span class="number">21</span>, n - <span class="number">21</span>)); i++) &#123;</span><br><span class="line">            ll u = i &lt;&lt; <span class="number">21</span>;</span><br><span class="line">            pll v = getB(u);</span><br><span class="line">            <span class="keyword">if</span> (v.first &lt; <span class="number">5e6</span> &amp;&amp; mini[v.first] &lt; <span class="number">1e12</span> &amp;&amp;</span><br><span class="line">                mini[v.first] + v.second &lt; minans) &#123;</span><br><span class="line">                minans = mini[v.first] + v.second;</span><br><span class="line">                mainans = u ^ ans[v.first];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    print(mainans);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="I-思维"><a href="#I-思维" class="headerlink" title="I.思维"></a>I.思维</h1><h2 id="题意-5"><a href="#题意-5" class="headerlink" title="题意"></a>题意</h2><p>给定$a,b$，目标是从$a$开始，仅通过加或者减去一个质数，最终使$a$变成$b$。</p>
<p>输出最小的路径。</p>
<p>$a,b\le 1e15$</p>
<h2 id="题解-5"><a href="#题解-5" class="headerlink" title="题解"></a>题解</h2><p>发现奇数加奇数会变成偶数。</p>
<p>所以如果要从一个奇数变成另一个奇数，只能通过$2$这个特别的质数。</p>
<p>具体的，有几种做法：</p>
<ul>
<li>先变成$2$，再变成$b$</li>
<li>通过反复加$2$到达$b$</li>
</ul>
<p>具体的，有一些结论：</p>
<ul>
<li>如果$a-2$是质数，那么$a$可以直接变成$2$</li>
<li>如果$a+2$是质数，那么$a$可以先加$2$再变成$2$</li>
<li>如果$b-2$是质数，那么$2$可以直接变成$b$</li>
<li>如果$b+2$是质数，那么$2$可以先变成$b+2$再变成$b$。</li>
</ul>
<p>以上，需要判断的质数数量不会超过$4$个，所以即使是$O(b\sqrt b)$的时间复杂度也是可以接受的。</p>
<h2 id="代码-5"><a href="#代码-5" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line">ll a, b;</span><br><span class="line"><span class="built_in">vector</span>&lt;ll&gt; ans;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">isprime</span><span class="params">(ll a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">2</span>; i * i &lt;= a; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a % i == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">a2</span><span class="params">(<span class="keyword">bool</span> u, <span class="keyword">bool</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (u) &#123;</span><br><span class="line">        ans.pb(b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (!v) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"Unlucky Benny"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> ans.pb(b + <span class="number">2</span>), ans.pb(b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ans.pb(a);</span><br><span class="line">    <span class="keyword">if</span> (b - <span class="number">2</span> == a) &#123;</span><br><span class="line">        ans.pb(b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (b - <span class="number">4</span> == a &amp;&amp; isprime(b - <span class="number">2</span>) &amp;&amp; isprime(a - <span class="number">2</span>)) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Poor Benny"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (a == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">bool</span> u = isprime(b - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">bool</span> v = isprime(b + <span class="number">2</span>);</span><br><span class="line">        a2(u, v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">bool</span> x = isprime(a - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">bool</span> y = isprime(a + <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span> (!x) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!y) &#123;</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">"Unlucky Benny"</span>);</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> solve(a + <span class="number">2</span>, b);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            ans.pb(<span class="number">2</span>);</span><br><span class="line">            <span class="keyword">bool</span> u = isprime(b - <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">bool</span> v = isprime(b + <span class="number">2</span>);</span><br><span class="line">            a2(u, v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;a, &amp;b);</span><br><span class="line">    solve(a, b);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld"</span>, ans[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; sz(ans); i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"-&gt;%lld"</span>, ans[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="J-树上最大字段和"><a href="#J-树上最大字段和" class="headerlink" title="J. 树上最大字段和"></a>J. 树上最大字段和</h1><h2 id="题意-6"><a href="#题意-6" class="headerlink" title="题意"></a>题意</h2><p>求树上最大子段和</p>
<h2 id="题解-6"><a href="#题解-6" class="headerlink" title="题解"></a>题解</h2><p>基本思想是维护树上区间的前缀、后缀最大值和总和，把区间拼接反转得到整条路径的答案。</p>
<p>具体实现可以用倍增、LCT或树剖 + 线段树。其中倍增的代码量更小一些。</p>
<h2 id="代码（LCT）"><a href="#代码（LCT）" class="headerlink" title="代码（LCT）"></a>代码（LCT）</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">const</span> LL INF = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200010</span>;</span><br><span class="line"><span class="keyword">int</span> f[N], son[N][<span class="number">2</span>], tmp[N];</span><br><span class="line"><span class="keyword">bool</span> rev[N];</span><br><span class="line">LL s[N], lgss[N], rgss[N], gss[N], size[N], val[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isroot</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> !f[x] || son[f[x]][<span class="number">0</span>] != x &amp;&amp; son[f[x]][<span class="number">1</span>] != x; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rev1</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) <span class="keyword">return</span>;</span><br><span class="line">    swap(son[x][<span class="number">0</span>], son[x][<span class="number">1</span>]);</span><br><span class="line">    swap(lgss[x], rgss[x]);</span><br><span class="line">    rev[x] ^= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pb</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (rev[x]) rev1(son[x][<span class="number">0</span>]), rev1(son[x][<span class="number">1</span>]), rev[x] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ls = son[x][<span class="number">0</span>], rs = son[x][<span class="number">1</span>];</span><br><span class="line">    size[x] = size[ls] + size[rs] + <span class="number">1</span>;</span><br><span class="line">    s[x] = s[ls] + s[rs] + val[x];</span><br><span class="line">    lgss[x] = max(lgss[ls], s[ls] + val[x] + max(lgss[rs], <span class="number">0l</span>l));</span><br><span class="line">    rgss[x] = max(rgss[rs], s[rs] + val[x] + max(rgss[ls], <span class="number">0l</span>l));</span><br><span class="line">    gss[x] = val[x] + max(max(rgss[ls], lgss[rs]), max(<span class="number">0l</span>l, lgss[rs] + rgss[ls]));</span><br><span class="line">    gss[x] = max(gss[x], max(gss[ls], gss[rs]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y = f[x], w = son[y][<span class="number">1</span>] == x;</span><br><span class="line">    son[y][w] = son[x][w ^ <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (son[x][w ^ <span class="number">1</span>]) f[son[x][w ^ <span class="number">1</span>]] = y;</span><br><span class="line">    <span class="keyword">if</span> (f[y]) &#123;</span><br><span class="line">        <span class="keyword">int</span> z = f[y];</span><br><span class="line">        <span class="keyword">if</span> (son[z][<span class="number">0</span>] == y)</span><br><span class="line">            son[z][<span class="number">0</span>] = x;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (son[z][<span class="number">1</span>] == y)</span><br><span class="line">            son[z][<span class="number">1</span>] = x;</span><br><span class="line">    &#125;</span><br><span class="line">    f[x] = f[y];</span><br><span class="line">    f[y] = x;</span><br><span class="line">    son[x][w ^ <span class="number">1</span>] = y;</span><br><span class="line">    up(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> s = <span class="number">1</span>, i = x, y;</span><br><span class="line">    tmp[<span class="number">1</span>] = i;</span><br><span class="line">    <span class="keyword">while</span> (!isroot(i)) tmp[++s] = i = f[i];</span><br><span class="line">    <span class="keyword">while</span> (s) pb(tmp[s--]);</span><br><span class="line">    <span class="keyword">while</span> (!isroot(x)) &#123;</span><br><span class="line">        y = f[x];</span><br><span class="line">        <span class="keyword">if</span> (!isroot(y)) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((son[f[y]][<span class="number">0</span>] == y) ^ (son[y][<span class="number">0</span>] == x))</span><br><span class="line">                rotate(x);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                rotate(y);</span><br><span class="line">        &#125;</span><br><span class="line">        rotate(x);</span><br><span class="line">    &#125;</span><br><span class="line">    up(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">access</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; x; y = x, x = f[x]) splay(x), son[x][<span class="number">1</span>] = y, up(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">root</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    access(x);</span><br><span class="line">    splay(x);</span><br><span class="line">    <span class="keyword">while</span> (son[x][<span class="number">0</span>]) x = son[x][<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">makeroot</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    access(x);</span><br><span class="line">    splay(x);</span><br><span class="line">    rev1(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    makeroot(x);</span><br><span class="line">    f[x] = y;</span><br><span class="line">    access(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">split</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    makeroot(y);</span><br><span class="line">    access(x);</span><br><span class="line">    splay(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n, m, op, x, y, z, a[N], b[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;a[i], &amp;b[i]);</span><br><span class="line">        lgss[<span class="number">0</span>] = rgss[<span class="number">0</span>] = gss[<span class="number">0</span>] = -INF;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;val[i]);</span><br><span class="line">            rev[i] = son[i][<span class="number">0</span>] = son[i][<span class="number">1</span>] = f[i] = <span class="number">0</span>;</span><br><span class="line">            size[i] = <span class="number">1</span>;</span><br><span class="line">            lgss[i] = rgss[i] = gss[i] = val[i];</span><br><span class="line">            s[i] = val[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) link(a[i], b[i]);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);</span><br><span class="line">        <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">            split(x, y);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, gss[x]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="代码（树剖-线段树）"><a href="#代码（树剖-线段树）" class="headerlink" title="代码（树剖 + 线段树）"></a>代码（树剖 + 线段树）</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cin</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> db = <span class="keyword">double</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1</span> &lt;&lt; <span class="number">18</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">3e5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">    LL pre, suf, max, sum;</span><br><span class="line">&#125;T[M + M + <span class="number">5</span>], null;</span><br><span class="line"></span><br><span class="line"><span class="function">Node <span class="title">merge</span><span class="params">(Node l, Node r)</span> </span>&#123;</span><br><span class="line">    Node res;</span><br><span class="line">    res.sum = l.sum + r.sum;</span><br><span class="line">    res.pre = <span class="built_in">std</span>::max(l.pre, l.sum + r.pre);</span><br><span class="line">    res.suf = <span class="built_in">std</span>::max(r.suf, l.suf + r.sum);</span><br><span class="line">    res.max = <span class="built_in">std</span>::max(l.max, r.max);</span><br><span class="line">    res.max = <span class="built_in">std</span>::max(res.max, l.suf + r.pre);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (T[n += M] = &#123; v, v, v, v &#125;, n &gt;&gt;= <span class="number">1</span>; n; n &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        T[n] = merge(T[n + n], T[n + n + <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Node <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    Node resL(null), resR(null);</span><br><span class="line">    <span class="keyword">for</span> (l += M - <span class="number">1</span>, r += M + <span class="number">1</span>; l ^ r ^ <span class="number">1</span>; l &gt;&gt;= <span class="number">1</span>, r &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (~l &amp; <span class="number">1</span>)resL = merge(resL, T[l ^ <span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span> (r &amp; <span class="number">1</span>) resR = merge(T[r ^ <span class="number">1</span>], resR);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> merge(resL, resR);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> top[MAXN], fa[MAXN], depth[MAXN], sz[MAXN], tid[MAXN], son[MAXN];</span><br><span class="line"><span class="keyword">int</span> cnt;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cnt = <span class="number">1</span>;</span><br><span class="line">    null.max = null.pre = null.suf = <span class="number">-1e18</span>;</span><br><span class="line">    <span class="built_in">std</span>::fill(son, son + MAXN, <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> pre)</span> </span>&#123;</span><br><span class="line">    depth[u] = depth[pre] + <span class="number">1</span>;</span><br><span class="line">    fa[u] = pre;</span><br><span class="line">    sz[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : G[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v != pre) &#123;</span><br><span class="line">            dfs1(v, u);</span><br><span class="line">            sz[u] += sz[v];</span><br><span class="line">            <span class="keyword">if</span> (son[u] == <span class="number">-1</span> || sz[v] &gt; sz[son[u]])son[u] = v;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">    top[u] = t;</span><br><span class="line">    tid[u] = cnt++;</span><br><span class="line">    <span class="keyword">if</span> (son[u] == <span class="number">-1</span>)<span class="keyword">return</span>;</span><br><span class="line">    dfs2(son[u], t);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : G[u])</span><br><span class="line">        <span class="keyword">if</span> (v != son[u] &amp;&amp; v != fa[u])dfs2(v, v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Node <span class="title">lca</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    Node resL(null), resR(null);</span><br><span class="line">    <span class="keyword">int</span> f1 = top[u], f2 = top[v];</span><br><span class="line">    Node t;</span><br><span class="line">    <span class="keyword">while</span> (f1 != f2) &#123;</span><br><span class="line">        <span class="keyword">if</span> (depth[f1] &gt; depth[f2]) &#123;</span><br><span class="line">            t = query(tid[f1], tid[u]);</span><br><span class="line">            resL = merge(t, resL);</span><br><span class="line">            u = fa[f1];</span><br><span class="line">            f1 = top[u];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            resR = merge(query(tid[f2], tid[v]), resR);</span><br><span class="line">            v = fa[f2];</span><br><span class="line">            f2 = top[v];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (depth[u] &lt; depth[v]) &#123;</span><br><span class="line">        resR = merge(query(tid[u], tid[v]), resR);</span><br><span class="line">        <span class="built_in">std</span>::swap(resL.pre, resL.suf);</span><br><span class="line">        <span class="keyword">return</span> merge(resL, resR);</span><br><span class="line">    &#125;</span><br><span class="line">    resL = merge(query(tid[v], tid[u]), resL);</span><br><span class="line">    <span class="built_in">std</span>::swap(resR.pre, resR.suf);</span><br><span class="line">    <span class="keyword">return</span> merge(resR, resL);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="built_in">cin</span>.sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        G[u].push_back(v), G[v].push_back(u);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs1(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    dfs2(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x; i &lt;= n; ++i) <span class="built_in">cin</span> &gt;&gt; x, update(tid[i], x);</span><br><span class="line">    <span class="keyword">int</span> q; <span class="built_in">cin</span> &gt;&gt; q;</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</span><br><span class="line">        <span class="keyword">if</span> (tid[x] &gt; tid[y]) <span class="built_in">std</span>::swap(x, y);</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; lca(x, y).max &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="代码（倍增）"><a href="#代码（倍增）" class="headerlink" title="代码（倍增）"></a>代码（倍增）</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cin</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">21</span>;</span><br><span class="line"><span class="keyword">const</span> LL INF = <span class="number">1e18</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">    LL pre, suf, sum, max;</span><br><span class="line">&#125;T[MAXN][M], null;</span><br><span class="line"></span><br><span class="line"><span class="function">Node <span class="title">merge</span><span class="params">(Node l, Node r)</span> </span>&#123;</span><br><span class="line">    Node res;</span><br><span class="line">    res.sum = l.sum + r.sum;</span><br><span class="line">    res.pre = <span class="built_in">std</span>::max(l.pre, l.sum + r.pre);</span><br><span class="line">    res.suf = <span class="built_in">std</span>::max(r.suf, l.suf + r.sum);</span><br><span class="line">    res.max = <span class="built_in">std</span>::max(l.max, r.max);</span><br><span class="line">    res.max = <span class="built_in">std</span>::max(res.max, l.suf + r.pre);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f[MAXN][M];</span><br><span class="line"><span class="keyword">int</span> depth[MAXN];</span><br><span class="line"><span class="keyword">int</span> w[MAXN];</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> pre)</span> </span>&#123;</span><br><span class="line">    depth[u] = depth[pre] + <span class="number">1</span>;</span><br><span class="line">    f[u][<span class="number">0</span>] = pre; <span class="comment">// f[u][1] = f[pre][0];</span></span><br><span class="line">    T[u][<span class="number">0</span>] = &#123; w[u], w[u], w[u], w[u] &#125;;</span><br><span class="line">    <span class="comment">// T[u][1] = merge(T[u][0], T[pre][0]);</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; M; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span>&amp; p = f[u][i - <span class="number">1</span>];</span><br><span class="line">        f[u][i] = f[p][i - <span class="number">1</span>];</span><br><span class="line">        T[u][i] = merge(T[u][i - <span class="number">1</span>], T[p][i - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : G[u])</span><br><span class="line">        <span class="keyword">if</span> (v != pre) dfs(v, u);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (depth[x] &lt; depth[y]) <span class="built_in">std</span>::swap(x, y);</span><br><span class="line">    Node rx(null), ry(null);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = M - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (depth[x] - (<span class="number">1</span> &lt;&lt; i) &gt;= depth[y]) &#123;</span><br><span class="line">            rx = merge(rx, T[x][i]);</span><br><span class="line">            x = f[x][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    assert(depth[x] == depth[y]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (x == y) &#123;</span><br><span class="line">        rx = merge(rx, T[x][<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">return</span> rx.max;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = M - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (f[x][i] == f[y][i]) <span class="keyword">continue</span>;</span><br><span class="line">        rx = merge(rx, T[x][i]);</span><br><span class="line">        ry = merge(ry, T[y][i]);</span><br><span class="line">        x = f[x][i], y = f[y][i];</span><br><span class="line">    &#125;</span><br><span class="line">    assert(x != y &amp;&amp; f[x][<span class="number">0</span>] == f[y][<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    rx = merge(rx, T[x][<span class="number">1</span>]);</span><br><span class="line">    ry = merge(ry, T[y][<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">std</span>::max(rx.suf + ry.suf, <span class="built_in">std</span>::max(rx.max, ry.max));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    null = &#123; -INF, -INF, <span class="number">0</span>, -INF &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x, y; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</span><br><span class="line">        G[x].push_back(y), G[y].push_back(x);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">cin</span> &gt;&gt; w[i];</span><br><span class="line"></span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> q; <span class="built_in">cin</span> &gt;&gt; q;</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; query(x, y) &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="K-计数DP"><a href="#K-计数DP" class="headerlink" title="K. 计数DP"></a>K. 计数DP</h1><h2 id="题意-7"><a href="#题意-7" class="headerlink" title="题意"></a>题意</h2><p>问有多少个序列，满足以下条件：</p>
<ul>
<li>长度为$n$，每个元素的大小为$[1,k]$。</li>
<li>有$t$种方法使得能取出连续$d$个大小相同的元素。</li>
</ul>
<p>$n,t,d\le 3333$</p>
<p>$k\le 1e9$</p>
<h2 id="题解-7"><a href="#题解-7" class="headerlink" title="题解"></a>题解</h2><p>稍加思索后发现可以是使用动态规划来做。</p>
<p>定义状态$dp[i][j]$代表前$i$个位置有$j$种方法能取出连续$d$个大小相同的元素。</p>
<p>假定每次$dp$转移位置与之前的部分异色。</p>
<p>那么</p>
<script type="math/tex; mode=display">dp[i][j]=(k-1)*(\displaystyle\sum_{u=1}^{i-d}{dp[u][j-(i-u-d+1)]+\displaystyle\sum_{u=i-d+1}^{i-1}{d[u][j]}})</script><p>其中，$k-1$是因为需要和上一种颜色不同。</p>
<p>特别的，需要一开始预处理$dp[0][0]$的转移情况。</p>
<p>时间复杂度$O(n^2*t)$</p>
<p>注意到上式可以通过前缀和优化，最终时间复杂度$O(n*t)$</p>
<h2 id="代码-6"><a href="#代码-6" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mn = <span class="number">3343</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> P mod</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, d, t, k;</span><br><span class="line"></span><br><span class="line">ll dp[mn][mn];</span><br><span class="line">ll sum[mn][mn];</span><br><span class="line">ll S[<span class="number">2</span>][<span class="number">100005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">getmod</span><span class="params">(ll &amp;u)</span> </span>&#123; u %= mod; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;n, &amp;d, &amp;t, &amp;k);</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    dp[d][<span class="number">1</span>] = k;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= t; j++) &#123;</span><br><span class="line">            <span class="keyword">int</span> u = max(<span class="number">0</span>, i - d);</span><br><span class="line">            dp[i][j] += (sum[i - <span class="number">1</span>][j] - sum[u][j]) * (k - <span class="number">1</span>) % mod;</span><br><span class="line">            <span class="keyword">if</span> (j == <span class="number">0</span> &amp;&amp; i - d &lt; <span class="number">0</span>) dp[i][j] += k;</span><br><span class="line">            dp[i][j] %= mod;</span><br><span class="line"></span><br><span class="line">            S[<span class="number">1</span>][i - j] += dp[i][j];</span><br><span class="line">            getmod(S[<span class="number">1</span>][i - j]);</span><br><span class="line">            <span class="keyword">if</span> (i + d &lt;= n &amp;&amp; j + <span class="number">1</span> &lt;= t) &#123;</span><br><span class="line">                dp[i + d][j + <span class="number">1</span>] += S[<span class="number">1</span>][i - j] * (k - <span class="number">1</span>) % mod;</span><br><span class="line">                <span class="keyword">if</span> (i - j == <span class="number">0</span>) dp[i + d][j + <span class="number">1</span>] += k;</span><br><span class="line">            &#125;</span><br><span class="line">            sum[i][j] += sum[i - <span class="number">1</span>][j] + dp[i][j];</span><br><span class="line">            getmod(sum[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, (dp[n][t] + mod) % mod);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/contest/" rel="tag"># contest</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/02/23/BAPC17/" rel="next" title="EyeBigBird2 BAPC 17 2019.02.17">
                <i class="fa fa-chevron-left"></i> EyeBigBird2 BAPC 17 2019.02.17
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/03/03/cf18winter/" rel="prev" title="2019 寒假集训 codeforces 部分">
                2019 寒假集训 codeforces 部分 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Trote_w</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#A-字符串分类讨论（大串暴力匹配，小串哈希处理）"><span class="nav-number">1.</span> <span class="nav-text">A. 字符串分类讨论（大串暴力匹配，小串哈希处理）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#题意"><span class="nav-number">1.1.</span> <span class="nav-text">题意</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#题解"><span class="nav-number">1.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#代码"><span class="nav-number">1.3.</span> <span class="nav-text">代码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#D-容斥-二维莫队"><span class="nav-number">2.</span> <span class="nav-text">D.容斥+二维莫队</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#题意-1"><span class="nav-number">2.1.</span> <span class="nav-text">题意</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#题解-1"><span class="nav-number">2.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#代码-1"><span class="nav-number">2.3.</span> <span class="nav-text">代码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#F-解方程"><span class="nav-number">3.</span> <span class="nav-text">F. 解方程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#题意-2"><span class="nav-number">3.1.</span> <span class="nav-text">题意</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#题解-2"><span class="nav-number">3.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#代码-2"><span class="nav-number">3.3.</span> <span class="nav-text">代码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#G-计数"><span class="nav-number">4.</span> <span class="nav-text">G.计数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#题意-3"><span class="nav-number">4.1.</span> <span class="nav-text">题意</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#题解-3"><span class="nav-number">4.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#代码-3"><span class="nav-number">4.3.</span> <span class="nav-text">代码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#H-思维状压DP"><span class="nav-number">5.</span> <span class="nav-text">H. 思维状压DP</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#题意-4"><span class="nav-number">5.1.</span> <span class="nav-text">题意</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#题解-4"><span class="nav-number">5.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#代码-4"><span class="nav-number">5.3.</span> <span class="nav-text">代码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#I-思维"><span class="nav-number">6.</span> <span class="nav-text">I.思维</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#题意-5"><span class="nav-number">6.1.</span> <span class="nav-text">题意</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#题解-5"><span class="nav-number">6.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#代码-5"><span class="nav-number">6.3.</span> <span class="nav-text">代码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#J-树上最大字段和"><span class="nav-number">7.</span> <span class="nav-text">J. 树上最大字段和</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#题意-6"><span class="nav-number">7.1.</span> <span class="nav-text">题意</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#题解-6"><span class="nav-number">7.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#代码（LCT）"><span class="nav-number">7.3.</span> <span class="nav-text">代码（LCT）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#代码（树剖-线段树）"><span class="nav-number">7.4.</span> <span class="nav-text">代码（树剖 + 线段树）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#代码（倍增）"><span class="nav-number">7.5.</span> <span class="nav-text">代码（倍增）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#K-计数DP"><span class="nav-number">8.</span> <span class="nav-text">K. 计数DP</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#题意-7"><span class="nav-number">8.1.</span> <span class="nav-text">题意</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#题解-7"><span class="nav-number">8.2.</span> <span class="nav-text">题解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#代码-6"><span class="nav-number">8.3.</span> <span class="nav-text">代码</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Trote_w</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  








  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
